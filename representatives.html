<!doctype html>
<html lang="en">
<head>
    <title>
        TRX BlockChain Explorer
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Description" content="TRX BlockChain Explorer." />
    <meta name="format-detection" content="telephone=no" />
    <link rel="shortcut icon" href="images/favicon.ico" />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/style-mod.css" />
    <link rel="stylesheet" href="assets/css/custom-head-foot-scroll-blue.css" />
    <link rel="stylesheet" href="assets/plugins/line-icons/line-icons.css" />
    <link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="assets/css/loading.css">
    <link rel="Stylesheet" href="assets/css/jquery-ui.min.css" type="text/css" />
    <style type="text/css">
        table tr td{
            word-break:break-all;
        }
    </style>
</head>
<body>
<div class="wrapper">
    <div class="header">
        <div class="container">
            <a class="logo" href="/" target="_parent" title="Home Page">
                <img id="logo-header" src="images/logo.png" alt="Logo" style="margin-top: 16px; margin-bottom: 14px; margin-left: -6px">
            </a>
            <div class="topbar hidden-xs hidden-sm ">
                <ul class="loginbar pull-right">
                    <li>
                        <div style="display: inline;">
                            <input id="txtSearchInput" type="text" class="form-control-custom" placeholder="Address / TxHash / Block Number / Token Name" name="search" maxlength="66" style="width: 330px; height: 31px;outline: none;">
                            <span class="" style="display: inline">
                                <button class="btn-u" id="searchBtn" type="button" style="padding: 2px 6px 3px; height: 31px; width: 41px; margin-left: -5px; margin-top: 3px;">GO</button>
                            </span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="collapse navbar-collapse mega-menu navbar-responsive-collapse">
            <div class="container">
            <ul class="nav navbar-nav">
                        <li id="LI_default">
                            <a href="home.html">HOME</a>
                        </li>
                        <li id="LI_block">
                            <a href="blocks.html?number=">BLOCKS</a>
                        </li>
                        <li id="LI_accounts">
                            <a href="accounts.html?balance=">ACCOUNTS</a>
                        </li>
                        <li id="LI_transactions">
                            <a href="transactions.html?hash=">TRANSACTIONS</a>
                        </li>
                        <li id="LI_nodes">
                            <a href="nodes.html">NODES</a>
                        </li>
                        <li id="LI_representatives" class="active">
                            <a href="representatives.html">REPRESENTATIVES</a>
                        </li>
                        <li id="LI_tokens">
                            <a href="tokens.html?name=">TOKENS</a>
                        </li>
                    </ul>
            </div>
        </div>
    </div>
    <!-- 头部结束 -->
    <!-- 搜索 -->
    <div class="container left hidden-lg hidden-md" id="divmobilesearch" style="margin-top: 5px;  padding-right: 20px; padding-left: 20px;">
        <form action="/search" method="GET">
        <input id="txtSearchInputMobile" type="text" placeholder="Search for Account, Tx Hash or Data" class="form-control" style="text-align: center;" name="q" maxlength="66" title="Address, Contract, Txn Hash or Data" />
        </form>
    </div>
    <div class="breadcrumbs" style="border-bottom: none;">
        <div class="container">
            <h1 class="pull-left">Representatives <span class="lead-modify" style="color: #999999">&nbsp;</span></h1>
            <ul class="pull-right breadcrumb">
                <li><a href="home.html">Home</a></li>
                <li class="active"><a href="representatives.html">Representatives</a></li>
            </ul>
        </div>
    </div>
    <div class="profile container " style="margin-top: 5px">
        <div class="tab-content" style="padding: 1px 0;display: none;">
            <div class="tab-pane fade in active" id="overview">
                <div class="panel panel-info table-responsive">
                    <div class="panel-heading margin-bottom-15">
                        <h3 class="panel-title">Representatives <span id="blockNum"></span></h3>
                    </div>
                    <table id="ContentPlaceHolder1_maintable" class="table nav-justified" cellpadding="0" cellspacing="0">
                        <tr>
                            <td width="190">&nbsp;&nbsp;confirmed:</td>
                            <td id="confirmed"></td>
                        </tr>
                        <tr>
                            <td width="190">&nbsp;&nbsp;hash:</td>
                            <td id="hash"></td>
                        </tr>
                        <tr>
                            <td width="190">&nbsp;&nbsp;number:</td>
                            <td id="number"></td>
                        </tr>
                        <tr>
                            <td width="190">&nbsp;&nbsp;timestamp:</td>
                            <td id="timestamp"></td>
                        </tr>
                        <tr>
                            <td width="190">&nbsp;&nbsp;nrOfTrx:</td>
                            <td id="trx"></td>
                        </tr>
                        <tr>
                            <td width="190">&nbsp;&nbsp;parentHash:</td>
                            <td id="parentHash"></td>
                        </tr>
                        <tr>
                            <td width="190">&nbsp;&nbsp;witnessAddress:</td>
                            <td id="witnessAddress"></td>
                        </tr>
                        <tr>
                            <td width="190">&nbsp;&nbsp;size:</td>
                            <td id="size"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <div class="row" style="display: none;">
            <div>
                <div style="margin-left: 10px; margin-right: 10px">
                    <div class="table-responsive">
                        <table class="table table-hover ">
                            <thead>
                                <tr style="border-color: #E1E1E1; border-width: 1px; background-color: #F9F9F9; border-top-style: solid;">
                                    <th>#</th>
                                    <th>Name</th>
                                    <th>Last Block</th>
                                    <th>Blocks Produced</th>
                                    <th>Transactions</th>
                                    <th>Blocks Missed</th>
                                    <th>Productity</th>
                                    <th>Votes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!--  -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div id="example" style="text-align: right"> <ul id="pageLimit"></ul> </div>
        </div>
    </div>
<script type="text/javascript" src="assets/js/jquery.js"></script>
<script type="text/javascript" src="assets/js/loading.js"></script>
<script type="text/javascript" src="assets/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/js/bootstrap-paginator.min.js"></script>
<script type="text/javascript" src="assets/js/combine-js-bottom.js"></script>
<script type="text/javascript" src="assets/js/search.js"></script>
<script type="text/javascript">
    var Representatives = {
        listTotals:100,
        init:function(){
            this.SearchInfo();
            this.AddLock();
        },SearchInfo:function(){
            $('#searchBtn').click(function(){
                var txt = $('#txtSearchInput').val();
                test.search(txt);
            })
        },
        AddLock:function(){
            var number =  this.splitURL('number=');
            if(number == "" || number == undefined){
                $('.tab-content').hide();
                $('.profile .row').show();
                this.AddEvent()
                return false;
            }else{
                $('.profile .row').hide();
                $('.tab-content').show();
                this.AddInfor();
                return false;
            }
        },
        AddEvent:function(){
            $("[rel='tooltip']").tooltip({ html: true });
            var load = new Loading();
            load.init({
                target:'.profile'
            });
            load.start();
            $.ajax({
                url:'https://api.tronscan.org/api/witness?sort=-votes',
                type:'GET',
                data:{},
                dataType:'JSON',
                success:function (data) {
                    load.stop();
                    var len = data.length;
                    var str = '';
                    $('tbody').empty();
                    for(var i=0;i<len;i++){
                        var num = parseFloat(data[i].latestBlockNumber+data[i].missedTotal),Productity=0;
                        if(num == 0){
                            Productity = 0
                        }else{
                            Productity = parseFloat(data[i].latestBlockNumber/(data[i].latestBlockNumber+data[i].missedTotal))*100;
                        }
                        if(Productity>1){
                            Productity = 100
                        }
                        str += '<tr>'+
                                '<td>'+(i+1)+'</td>'+
                                '<td>'+data[i].url+'</td>'+
                                '<td>'+data[i].latestBlockNumber+'</td>'+
                                '<td>'+data[i].producedTotal+'</td>'+
                                '<td>'+data[i].producedTrx+'</td>'+
                                '<td>'+data[i].missedTotal+'</td>'+
                                '<td>'+Productity+'%</td>'+
                                '<td>'+data[i].votes+'</td>'+
                                '</tr>'
                    }
                    $('tbody').append(str);
                }
            })
            
        },
        AddInfor:function(){
            var number =  this.splitURL('number=');
            $('#blockNum').html('#'+number)
            var load = new Loading();
            load.init({
                target:'.profile'
            });
            load.start();
            $('.tab-content').hide();
            $.ajax({
                url:'https://api.tronscan.org/api/witness/'+number,
                type:'GET',
                data:{},
                dataType:'JSON',
                success:function (res) {
                    load.stop();
                    $('.tab-content').show();
                    var confirmed = res.confirmed;
                    if(confirmed == false){
                        $('#confirmed').html('false');
                    }else{
                        $('#confirmed').html('true');
                    }
                    // $('#confirmed').html(res.confirmed);
                    $('#hash').html(res.hash);
                    $('#number').html(res.number);
                    $('#timestamp').html(res.timestamp);
                    $('#trx').html(res.nrOfTrx);
                    $('#parentHash').html(res.parentHash);
                    $('#witnessAddress').html(res.witnessAddress);
                    $('#size').html(res.size);
                }
            })
        },
        splitURL:function(_str) { 
            var url = document.location.href,
                argsArray = [],
                i, len, argsName, argsVal, obj;
            if(url.indexOf('?') != -1) {
                argsArray = url.split("?")[1].split("&");
                len = argsArray.length;
                var num = _str.length;
                for(i = 0; i < len; i++) {
                    if (argsArray[i].indexOf(_str) == 0) {
                        argsVal = argsArray[i].substring(num);
                        obj = decodeURIComponent(argsVal);
                    }
                }
            }
            return obj;
        }
    }
   $(document).ready(function(){
        Representatives.init();
   })
   
</script>
</body>
</html>
